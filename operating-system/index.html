<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.22" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.82" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","name":"操作系统","description":"现代计算机系统由一个或多个处理器、主存、磁盘、打印机、键盘、鼠标、显示器、网络接口以及各种其他输入/输出设备组成。一般而言，现代计算机系统是一个复杂的系统。如果每个程序员都不得不掌握系统所有的细节，那就不可能再编写代码了。而且，管理所有这些部件并加以优化使用，是一件挑战性极强的工作。所以计算机安装了一层软件直接运行在裸机上，称为操作系统，它的任务是为用..."}</script><meta property="og:url" content="https://jinqiu.wang/operating-system/"><meta property="og:site_name" content="JQiue's notes"><meta property="og:title" content="操作系统"><meta property="og:description" content="现代计算机系统由一个或多个处理器、主存、磁盘、打印机、键盘、鼠标、显示器、网络接口以及各种其他输入/输出设备组成。一般而言，现代计算机系统是一个复杂的系统。如果每个程序员都不得不掌握系统所有的细节，那就不可能再编写代码了。而且，管理所有这些部件并加以优化使用，是一件挑战性极强的工作。所以计算机安装了一层软件直接运行在裸机上，称为操作系统，它的任务是为用..."><meta property="og:type" content="website"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-06-19T06:51:15.000Z"><meta property="article:modified_time" content="2025-06-19T06:51:15.000Z"><script deref src="https://track.jinqiu.wang/js/tracker.js" data-website-id="1" data-server-url="https://track.jinqiu.wang"></script><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#5c92d1"><link rel="icon" href="/favicon.ico"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><link rel="apple-touch-icon" href="/assets/icon/appleIcon152.png"><title>操作系统 | JQiue's notes</title><meta name="description" content="现代计算机系统由一个或多个处理器、主存、磁盘、打印机、键盘、鼠标、显示器、网络接口以及各种其他输入/输出设备组成。一般而言，现代计算机系统是一个复杂的系统。如果每个程序员都不得不掌握系统所有的细节，那就不可能再编写代码了。而且，管理所有这些部件并加以优化使用，是一件挑战性极强的工作。所以计算机安装了一层软件直接运行在裸机上，称为操作系统，它的任务是为用...">
    <link rel="preload" href="/assets/style-BhfYYStb.css" as="style"><link rel="stylesheet" href="/assets/style-BhfYYStb.css">
    <link rel="modulepreload" href="/assets/app-BvEWR9Cw.js"><link rel="modulepreload" href="/assets/index.html-elarayVB.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="/logo.png" alt><!----><span class="vp-site-name hide-in-pad">JQiue&#39;s notes</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="首页" iconsizing="height"><!--[--><i class="vp-icon iconfont icon-zhuye" sizing="height"></i><!--]-->首页<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="技能"><!--[--><i class="vp-icon iconfont icon-jishuzhan" sizing="height"></i>技能<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/composition/" aria-label="计算机组成" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-yuanli" sizing="both"></i><!--]-->计算机组成<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/operating-system/" aria-label="操作系统" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-caozuoxitong" sizing="both"></i><!--]-->操作系统<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/network/" aria-label="计算机网络" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-wangluo" sizing="both"></i><!--]-->计算机网络<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/compiler/" aria-label="编译原理" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-bianyi" sizing="both"></i><!--]-->编译原理<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/database/" aria-label="数据库" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-SQL" sizing="both"></i><!--]-->数据库<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/ds-algorithm/" aria-label="数据结构与算法" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-suanfa" sizing="both"></i><!--]-->数据结构与算法<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/ai/" aria-label="人工智能" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-rengongzhineng" sizing="both"></i><!--]-->人工智能<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="编程语言"><!--[--><i class="vp-icon iconfont icon-kaifayuyan" sizing="height"></i>编程语言<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/c/" aria-label="C" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-c" sizing="both"></i><!--]-->C<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/java/" aria-label="Java" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-java" sizing="both"></i><!--]-->Java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/js/" aria-label="JavaScript" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-javascript" sizing="both"></i><!--]-->JavaScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/sundry/typescript.html" aria-label="TypeScript" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-typescript" sizing="both"></i><!--]-->TypeScript<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/python/" aria-label="Python" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-python" sizing="both"></i><!--]-->Python<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/rust/" aria-label="Rust" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-rust" sizing="both"></i><!--]-->Rust<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Web"><!--[--><i class="vp-icon iconfont icon-liulanqi" sizing="height"></i>Web<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/html-css/" aria-label="HTML/CSS" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-html" sizing="both"></i><!--]-->HTML/CSS<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/webapi/" aria-label="WebAPI" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-wangluo" sizing="both"></i><!--]-->WebAPI<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="框架"><!--[--><i class="vp-icon iconfont icon-framework" sizing="height"></i>框架<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/vue.html" aria-label="Vue" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-vue" sizing="both"></i><!--]-->Vue<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/react.html" aria-label="React" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-react" sizing="both"></i><!--]-->React<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/express.html" aria-label="Express" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-express" sizing="both"></i><!--]-->Express<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/koa.html" aria-label="Koa" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-koa" sizing="both"></i><!--]-->Koa<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/reactnative.html" aria-label="React Native" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-react" sizing="both"></i><!--]-->React Native<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/electron.html" aria-label="Electron" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-electron" sizing="both"></i><!--]-->Electron<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/framework/tauri.html" aria-label="Tauri" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-tauri" sizing="both"></i><!--]-->Tauri<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="基础学科"><!--[--><i class="vp-icon iconfont icon-kemu" sizing="height"></i>基础学科<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/subject/english.html" aria-label="英语" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-yingyu" sizing="both"></i><!--]-->英语<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/subject/math.html" aria-label="数学" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-math" sizing="both"></i><!--]-->数学<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/subject/physics.html" aria-label="物理" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-physics" sizing="both"></i><!--]-->物理<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/subject/chemistry.html" aria-label="化学" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-chemistry" sizing="both"></i><!--]-->化学<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/subject/biology.html" aria-label="生物" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-biology" sizing="both"></i><!--]-->生物<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/subject/history.html" aria-label="历史" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-history" sizing="both"></i><!--]-->历史<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/subject/logic.html" aria-label="逻辑学" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-logic" sizing="both"></i><!--]-->逻辑学<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/subject/economics-finance/" aria-label="经济和金融" iconsizing="both"><!--[--><i class="vp-icon iconfont icon-economics-finance" sizing="both"></i><!--]-->经济和金融<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/sundry/" aria-label="杂七杂八" iconsizing="height"><!--[--><i class="vp-icon iconfont icon-baibaoxiang" sizing="height"></i><!--]-->杂七杂八<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/JQiue/jqiue-notes" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div id="docsearch" style="display:none;"></div><div><button type="button" class="docsearch-btn" aria-label="搜索文档"><span class="docsearch-btn-icon-container"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="docsearch-modal-btn-icon"><path fill="currentColor" d="M21.71 20.29L18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a1 1 0 0 0 1.42 0a1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 7-7a7 7 0 0 1-7 7Z"></path></svg></span><span class="docsearch-btn-placeholder">搜索文档</span><span class="docsearch-btn-keys"><kbd class="docsearch-btn-key">Ctrl</kbd><kbd class="docsearch-btn-key">K</kbd></span></button></div><!--]--><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/operating-system/" aria-label="操作系统" iconsizing="both"><!---->操作系统<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/operating-system/windows.html" aria-label="Windows" iconsizing="both"><!---->Windows<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/operating-system/linux.html" aria-label="Linux" iconsizing="both"><!---->Linux<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->操作系统</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://jinqiu.wang/" target="_blank" rel="noopener noreferrer">JQiue</a></span><span property="author" content="JQiue"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025/6/19</span><meta property="datePublished" content="2025-06-19T06:51:15.000Z"></span><span class="page-pageview-info" aria-label="访问量🔢" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon" name="eye"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span id="ArtalkPV" class="vp-pageview waline-pageview-count" data-path="/operating-system/" data-page-key="/operating-system/">...</span></span><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 29 分钟</span><meta property="timeRequired" content="PT29M"></span><!----><!----></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><p>现代计算机系统由一个或多个处理器、主存、磁盘、打印机、键盘、鼠标、显示器、网络接口以及各种其他输入/输出设备组成。一般而言，现代计算机系统是一个复杂的系统。如果每个程序员都不得不掌握系统所有的细节，那就不可能再编写代码了。而且，管理所有这些部件并加以优化使用，是一件挑战性极强的工作。所以计算机安装了一层软件直接运行在裸机上，称为<strong>操作系统</strong>，它的任务是为用户程序提供一个更好、更简单、更清晰的计算机模型，并管理刚才提到的所有这些设备</p><p>操作系统无疑是最为复杂的软件，为无数的用户和应用程序提供服务，从用户角度来看，操作系统是一个控制软件，用于管理和运行应用程序。对下操作系统是整个计算机硬件的资源分配器、管理外设、分配资源。操作系统的层次是在硬件之上、软件之下。虽然操作系统本身是一种软件，但是它为其他的软件提供服务支撑，是软件对硬件的抽象，为上层应用提供统一的接口</p><p>Linux、Windows 的界面属于外壳（Shell），而不是内核（Kernel），对于操作系统更多的是站在内核的角度，内核底层更能看到操作系统里面的细节</p><p>Kernel - 操作系统内部组件：</p><ul><li>CPU 调度器</li><li>物理内存管理</li><li>虚拟内存管理</li><li>文件系统管理</li><li>中断处理与设备驱动</li><li>...</li></ul><p>Kernel 的特征：</p><ul><li>并发 - 计算机系统中同时存在多个运行的程序，需要 OS 管理和调度</li><li>共享 - “同时”访问、互斥共享</li><li>虚拟 - 利用多道程序设计技术，让每个用户都觉得一个计算机专门为它服务</li><li>异步 - 程序的执行不是一贯到底，而是走走停停，向前推进的速度不可预知，但只要运行环境相同，OS 需要保证程序运行的结果也要相同</li></ul><p>操作系统至今有以下家族：</p><ul><li>UNIX/Linux</li><li>Windows</li><li>macOS</li></ul><p>早期的计算机使用纸带传输程序和数据，操作系统只起到加载作用。随着 CPU 等硬件的发展，计算机的速度得到提升，但性能未能得到充分利用</p><p>在计算机系统运行时，在硬件设备上会重复执行以下步骤</p><ol><li>通过输入设备或网络适配器，向计算机发起请求</li><li>读取内存中的命令，并在 CPU 上执行，把结果写入负责保存数据的内存区域中</li><li>将内存中的数据写入 HDD（Hard Disk Drive，硬盘驱动器）、SDD（Solid State Disk，固态硬盘）等存储器，或者通过网络发送给其他计算机，或者通过输出设备提供给用户</li><li>回到步骤 1</li></ol><p>由这些重复执行的步骤整合而成的对用户有意义的处理，就称为程序。程序大体上分为以下几种</p><ul><li>应用程序：能让用户直接使用，为用户提供帮助的程序，例如计算机上的办公软件、智能手机和平板电脑上的应用</li><li>中间件：将对大部分应用程序通用的功能分离出来，以辅助应用程序运行的程序，例如 Web 服务器、数据库系统</li><li>OS：直接控制硬件设备，同时为应用程序与中间件提供运行环境的程序，例如 Linux</li></ul><p>通常情况下，程序在 OS 上以进程为单位运行。每个程序由一个或者多个进程构成。包括 Linux 在内的大部分 OS 能同时运行多个进程</p><p>调用外部设备（以下简称“设备”）是 Linux 的一个重要功能。如果没有 Linux 这样的 OS，就不得不为每个进程单独编写调用设备的代码</p><p>在这种情况下，会存在以下缺点</p><ul><li>应用程序开发人员必须精通调用各种设备的方法</li><li>开发成本高</li><li>当多个进程同时调用设备时，会引起各种预料之外的问题</li></ul><p>为了解决上述问题，Linux 把设备调用处理整合成了一个叫作设备驱动程序的程序，使进程通过设备驱动程序访问设备。虽然世界上存在各种设备，但对于同一类型的设备，Linux 可以通过同一个接口进行调用</p><p>在某个进程因为 Bug 或者程序员的恶意操作而违背了“通过设备驱动程序访问设备”这一规则的情况下，依然会出现多个进程同时调用设备的情况。为了避免这种情况，Linux 借助硬件，使进程无法直接访问设备。具体来说，CPU 存在内核模式和用户模式两种模式，只有处于内核模式时才允许访问设备。另外，使设备驱动程序在内核模式下运行，使进程在用户模式下运行</p><p>除此之外，还有许多不应被普通进程调用的处理程序，如下所示</p><ul><li>进程管理系统</li><li>进程调度器</li><li>内存管理系统</li></ul><p>这些程序也全都在内核模式下运行。把这些在内核模式下运行的 OS 的核心处理整合在一起的程序就叫作内核。如果进程想要使用设备驱动程序等由内核提供的功能，就需要通过被称为系统调用的特殊处理 来向内核发出请求</p><p>需要指出的是，OS 并不单指内核，它是由内核与许多在用户模式下运行的程序构成的。关于 Linux 中的在用户模式下运行的功能，以及作为进程与内核的通信接口的系统调用</p><p>内核负责管理计算机系统上的 CPU 和内存等各种资源，然后把这些资源按需分配给在系统上运行的各个进程</p><p>在进程运行的过程中，各种数据会以内存为中心，在 CPU 上的寄存器或外部存储器等各种存储器之间进行交换。这些存储器在容量、价格和访问速度等方面都有各自的优缺点，从而构成被称为存储层次的存储系统层次结构。从提高程序运行速度和稳定性方面来说，灵活有效地运用各种存储器是必不可少的一环</p><p>虽然可以通过设备驱动程序访问外部存储器中的数据，但为了简化这一过程，通常会利用被称为文件系统的程序进行访问</p><p>对于计算机系统来说，外部存储器是不可或缺的。在启动系统时，首先需要做的就是从外部存储器中读取 OS 。此外，为了防止在关闭电源时丢失系统运行期间在内存上创建的数据，必须在关闭电源前把这些数据写入外部存储器</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>准确地说，在读取 OS 之前，还存在以下操作：</p><ol><li>通过 BIOS（Basic Input Output System，基本输入 / 输出系统）或 UEFI（Unified Extensible Firmware Interface，统一可扩展固件接口）这种固化在硬件上的软件来初始化硬件设备；</li><li>运行引导程序来选择需要启动的 OS</li></ol></div><h2 id="用户模式" tabindex="-1"><a class="header-anchor" href="#用户模式"><span>用户模式</span></a></h2><p>OS 并非仅由内核构成，还包含许多在用户模式下运行的程序。这些程序有的以库的形式存在，有的作为单独的进程运行</p><p>一般来说，由在用户模式下运行的进程通过系统调用向内核发送相应的请求，其中存在进程独有的代码直接向内核发起请求的情况，也存在进程所依赖的库向内核发起请求的情况。另外，库分为 OS 提供的库与第三方库两种类型</p><p>从整个系统来说，除了应用程序与中间件之外，OS 自身也提供了各种各样的程序</p><h3 id="系统调用" tabindex="-1"><a class="header-anchor" href="#系统调用"><span>系统调用</span></a></h3><p>进程在执行创建进程、操控硬件等依赖于内核的处理时，必须通过系统调用向内核发起请求。系统调用的种类如下</p><ul><li>进程控制（创建和删除）</li><li>内存管理（分配和释放）</li><li>进程间通信</li><li>网络管理</li><li>文件系统操作</li><li>文件操作（访问设备）</li></ul><p>系统调用需要通过执行特殊的 CPU 命令来发起。通常进程运行在用户模式下，当通过系统调用向内核发送请求时，CPU 会发生名为中断的事件。这时，CPU 将从用户模式切换到内核模式，然后根据请求内容进行相应的处理。当内核处理完所有系统调用后，将重新回到用户模式，继续运行进程</p><p>内核在开始进行处理时验证来自进程的请求是否合理（例如，请求的内存量是否大于系统所拥有的内存量等）。如果请求不合理，系统调用将执行失败。需要注意的是，并不存在用户进程绕过系统调用而直接切换 CPU 运行模式的方法（假如有，内核就失去存在的意义了）</p><p>如果想了解进程究竟发起了哪些系统调用，可以通过 strace 命令对进程进行追踪</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">strace</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> strace.log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./hello</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>strace 的运行结果中的每一行对应一个系统调用</p><p>无论使用什么编程语言，都必须通过系统调用向内核发起请求</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">strace</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> py.log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> python</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./hello.py</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>甚至可以发现 python 发起的系统调用要比 C 多得多</p><p>sar 命令用于获取进程分别在用户模式与内核模式下运行的时间比例</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 每 1 秒输出所有的 CPU 运行时间比例</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -P</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:28:40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     %user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     %nice</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   %system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   %iowait</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    %steal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     %idle</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:28:41</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     all</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.25</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     99.75</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:28:41</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    100.00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:28:41</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.99</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     99.01</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:28:41</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    100.00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:28:41</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    100.00</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在每一行中，从 %user 字段到 %idle 字段表示在 CPU 核心上运行的处理的类型。同一行内全部字段的值的总和是 100%。通过上面展示的数据可以看出，一行数据对应一个 CPU 核心。CPU 字段中值为 all 的那一行数据是全部 CPU 核心的平均值</p><p>将 %user 字段与 %nice 字段的值相加得到的值是进程在用户模式下运行的时间比例，而 CPU 核心在内核模式下执行系统调用等处理所占的时间比例可以通过 %system 字段得到。在采集数据时，所有 CPU 核心的 %idle 字段 的值都几乎接近 100%。这里的 %idle 指的是 CPU 核心完全没有运行任何处理时的空闲（idle）状态</p><p>也可以通过 sar 命令的第 4 个参数来指定采集信息的次数</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 每 1 秒采集 1 次</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -P</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ALL</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果运行一个没有系统调用的程序，sar 将会这样</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Average:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     %user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     %nice</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   %system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   %iowait</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    %steal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     %idle</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Average:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        all</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     25.25</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.25</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     74.50</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Average:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    100.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Average:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    100.00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Average:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.99</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     99.01</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Average:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      1.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     99.00</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>程序始终运行在 CPU0 上，如果运行一个没有系统调用的程序，会发现 %system 占用了 35% 的执行时间，不是 100% 是因为，程序自身也需要处理循环。虽然不能一概而论，但当 %system 的值高达几十时，大多是陷入了系统调用发起过多，或者系统负载过高等糟糕的状态</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:36:59</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     CPU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     %user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     %nice</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   %system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   %iowait</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    %steal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     %idle</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:37:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     all</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     16.58</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      8.79</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     74.62</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:37:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    100.00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:37:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    100.00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:37:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      1.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     99.00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">03:37:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     65.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     35.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0.00</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 strace 命令后加上 -T 选项，就能以微秒级的精度来采集各种系统调用所消耗的实际时间。在发现 %system 的值过高时，可以通过这个功能来确认到底是哪个系统调用占用了过多的系统资源，下列例子中，输出 hello world\n 这一字符串总共花费了 115 微秒</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">execve(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;/usr/bin/nohup&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;nohup&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;./c.out&quot;],</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x7ffd58106b10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 23</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vars</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) = 0 &lt;0.000589&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">brk(NULL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)                               = 0x5570ff0b5000 &lt;0.000023&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">arch_prctl(0x3001</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ARCH_???</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x7fff64a38850</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) = -1 EINVAL (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Invalid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> argument</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) &lt;0.000021&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">access(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;/etc/ld.so.preload&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> R_OK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)      = -1 ENOENT (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">No</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) &lt;0.000031&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">openat(AT_FDCWD,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/etc/ld.so.cache&quot;,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> O_RDONLY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">O_CLOEXEC</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) = 3 &lt;0.000035&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">brk(0x55db21e0b000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)                     = 0x55db21e0b000 &lt;0.000027&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">write(1,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Hello World\n&quot;,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)           = 12 &lt;0.000115&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">exit_group(0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)                           = ?</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+++</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exited</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> with</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +++</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Linux 提供了所有或者说绝大多数进程所依赖的库函数，以为编写程序提供方便。需要注意的是，与常规的函数调用不同，系统调用并不能被 C 语言之类的高级编程语言直接发起，只能通过与系统架构紧密相连的汇编语言代码来发起</p><p>如果没有 OS 的帮助，程序员就不得不根据系统架构为每一个系统调用编写相应的汇编语言代码，然后再从高级编程语言中调用这些代码</p><p>这样一来，不但编写程序的时间增加了，程序也将无法移植到别的架构上</p><p>为了解决这样的问题，OS 提供了一系列被称为系统调用的包装函数的函数，用于在系统内部发起系统调用。各种架构上都存在着对应的包装函数。因此，使用高级编程语言编写的用户程序，只需调用由高级编程语言提供的包装函数即可</p><p>Linux 提供了 ldd 命令，用于查看程序所依赖的库</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">❯</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ldd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /bin/echo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fffaaf7d000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/lib/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fbe6f480000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fbe6f675000)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">❯</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ldd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /bin/python</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        linux-vdso.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007ffd4b95b000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libpython3.11.so.1.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/lib/libpython3.11.so.1.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fc28de00000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/lib/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fc28dc1e000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        libm.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/lib/libm.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fc28db31000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0x00007fc28e4c0000)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>libc 指的就是 C 标准库，C 语言拥有 ISO（International Standard Organization，国际标准化组织）定义的标准库，Linux 也提供了这些 C 语言标准库。不过，通常会以 GNU 项目提供的 glibc 作为 C 标准库使用。用 C 语言编写的几乎所有程序都依赖于 glibc 库</p><p>glibc 不仅包括系统调用的包装函数，还提供了 POSIX 标准 中定义的函数</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>这个标准定义了基于 UNIX 的 OS 应该具备的各种功能</p></div><p>python 命令同样也依赖于 libc，命令本身的实现也依赖于 C 标准库。可以说，在 OS 层面上，C 语言依然在默默地发挥着很大的作用，是一种不可或缺的编程语言。对系统上的其他程序使用 ldd 命令，会发现它们大部分也依赖于 libc</p><p>OS 提供的程序与 OS 提供的库一样，对绝大多数程序来说是不可或缺的。OS 同时还提供了作为自身一部分的、用于更改 OS 运行方式的程序</p><p>下面列举了一些 OS 提供的程序</p><ul><li>初始化系统：init</li><li>变更系统的运行方式：sysctl、nice、sync</li><li>文件操作：touch、mkdir</li><li>文本数据处理：grep、sort、uniq</li><li>性能测试：sar、iostat</li><li>编译：gcc</li><li>脚本语言运行环境：perl、python、ruby</li><li>shell：bash</li><li>视窗系统：X</li></ul><h2 id="进程" tabindex="-1"><a class="header-anchor" href="#进程"><span>进程</span></a></h2><p>进程是操作系统中最核心的概念，进程是对正在运行程序的一个抽象。操作系统的其他所有内容都是围绕着进程的概念展开的</p><p>进程是非常抽象的概念，即使可以利用的 CPU 只有一个，但也支持（伪）并发操作能力，将一个单独的 CPU 变换为多个虚拟的 CPU</p><p>所有的现代计算机经常会在同一时间做许多件事，当启动系统时，会秘密启动许多进程，所以一个支持多进程的多道程序系统是非常有必要的</p><p>在 Linux 中，创建进程有如下两个目的</p><ol><li>将同一个程序分成多个进程进行处理（例如，使用 Web 服务器接收多个请求）</li><li>创建另一个程序（例如，从 bash 启动一个新的程序）为了达成这两个目的，Linux 提供了 fork() 函数与 execve() 函数（其底层分别请求名为 clone() 与 execve() 的系统调用）。接下来，我们将介绍如何使用这两个函数</li></ol><p>要想将同一个程序分成多个进程进行处理，只需使用 fork() 函数即可。在调用 fork() 函数后，就会基于发起调用的进程，创建一个新的进程。发出请求的进程称为父进程，新创建的进程称为子进程</p><ol><li>为子进程申请内存空间，并复制父进程的内存到子进程的内存空间</li><li>父进程与子进程分裂成两个进程，以执行不同的代码。这一点的实现依赖于 fork() 函数分别返回不同的值给父进程与子进程</li></ol><p>在打算启动另一个程序时，需要调用 execve() 函数。首先，我们来看一下内核在运行进程时的流程</p><ol><li>读取可执行文件，并读取创建进程的内存映像所需的信息</li><li>用新进程的数据覆盖当前进程的内存</li><li>从最初的命令开始运行新的进程</li></ol><p>也就是说，在启动另一个程序时，并非新增一个进程，而是替换了当前进程</p><p>首先，读取可执行文件，以及创建进程的内存映像所需的信息。可执行文件中不仅包含进程在运行过程中使用的代码与数据，还包含开始运行程序时所需的数据。包含代码的代码段在文件中的偏移量、大小，以及内存映像的起始地址包含代码以外的变量等数据的数据段在文件中的偏移量、大小，以及内存映像的起始地址程序执行的第一条指令的内存地址（入口点）</p><p>与使用高级编程语言编写的源代码不同，在 CPU 上执行机器语言指令时，必须提供需要操作的内存地址，因此在代码段和数据段中必须包含内存映像的起始地址。比如，使用一种虚构的高级编程语言编写了如下一段源代码</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>c = a + b</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>在机器语言层面，这段源代码将转变成下面这样的直接对内存地址进行操作的指令</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>load m100 r0 ← 将内存地址 100（变量 a）的值读取到名为 r0 的寄存器中</span></span>
<span class="line"><span>load m200 r1 ← 将内存地址 200（变量 b）的值读取到名为 r1 的寄存器中</span></span>
<span class="line"><span>add r0 r1 r2 ← 将 r0与 r1相加，并将结果储存到名为 r2的寄存器中</span></span>
<span class="line"><span>store r2 m300 ← 将 r2的值储存到内存地址300（变量 c）</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接下来，基于读取的信息，将程序映射到内存上，最后，从入口点开始运行程序</p><p>然而，Linux 的可执行文件的结构遵循的是名为 ELF（Executableand Linkable Format，可执行与可链接格式）的格式，并非之前描述的那样简单的结构。ELF 的相关信息可以通过 readelf 命令来获取，Entry point address 这一行中的 0x1040 就是这个程序的入口点</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">❯</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> readelf</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> c.out</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ELF</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Header:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Entry</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> point</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> address:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">               0x1040</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过附加 -S 选项，可以获取代码段与数据段在文件中的偏移量、大小和起始地址</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">❯</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> readelf</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -S</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> c.out</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">There</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 30</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> headers,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> starting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> offset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x34b8:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Section</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Headers:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  [Nr] </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              Type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             Address</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           Offset</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">       Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              EntSize</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          Flags</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Info</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Align</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  [14] </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.text</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             PROGBITS</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         0000000000001040</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  00001040</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">       0000000000000113</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  AX</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     16</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  [24] </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             PROGBITS</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         0000000000004008</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  00003008</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">       0000000000000010</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0000000000000000</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  WA</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>输出的数据每两行为一组</li><li>全部数值皆为十六进制数</li><li>在每组的第 1 行的第 2 个字段中，.text 对应的是代码段的信息，.data 对应的是数据段的信息</li><li>在这些信息中，对于每组输出，只需要关注以下内容即可 <ul><li>每组的第 1 行的第 4 个字段：内存映像的起始地址</li><li>每组的第 1 行的第 5 个字段：在文件中的偏移量</li><li>每组的第 2 行的第 1 个字段：大小</li></ul></li></ul><p>在程序运行时创建的进程的内存映像信息，可以从<code>/proc/PID/maps</code>文件查看</p><p>在打算新建一个别的进程时，通常采用被称为 fork and exec 的方式，即由父进程调用 fork() 创建子进程，再由子进程调用 exec()，比如典型的 bash 进程创建 echo 进程创建</p><h3 id="进程调度" tabindex="-1"><a class="header-anchor" href="#进程调度"><span>进程调度</span></a></h3><p>Linux 内核具有进程调度器（以下简称“调度器”）的功能，它使得多个进程能够同时运行（准确来说，是看起来在同时运行）。大家在使用 Linux 系统时通常是意识不到调度器的存在的</p><ul><li>一个 CPU 同时只运行一个进程</li><li>在同时运行多个进程时，每个进程都会获得适当的时长 ，轮流在 CPU 上执行处理</li></ul><p>Linux 会将多核 CPU（现在几乎都是这样的 CPU）上的每一个核心都识别为一个 CPU。系统识别出来的 CPU（这里是指 CPU 核心）称为逻辑 CPU。另外，在开启了超线程功能时，每一个线程都会被识别为一个逻辑 CPU</p><p>在 Linux 中，<code>taskset</code>命令可以指定程序运行在某个逻辑 CPU 上</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">taskset</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">exe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">c&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>结论：</p><ul><li>每个进程都只在使用逻辑 CPU 期间推进进度，换一种说法就是，在别的进程运行时并不会推进进度</li><li>单位时间推进的进度约为运行单个进程时的 1/2。在进程数量为1 时，每毫秒推进 1% 左右；在进程数量为 2 时，每毫秒推进0.5% 左右</li><li>处理完所有进程所消耗的时间约为运行单个进程时的 2 倍</li><li>不管同时运行多少个进程，在任意时间点上，只能有一个进程运行在逻辑 CPU 上</li><li>在逻辑 CPU 上运行多个进程时，它们将按轮询调度的方式循环运行，即所有进程按顺序逐个运行，一轮过后重新从第一个进程开始轮流运行</li><li>每个进程被分配到的时间片的长度大体上相等</li><li>全部进程运行结束所消耗的时间，随着进程数量的增加而等比例地增加</li></ul><h3 id="上下文切换" tabindex="-1"><a class="header-anchor" href="#上下文切换"><span>上下文切换</span></a></h3><p>操作系统通过时间切片算法，为每个进程安排固定时间片用来运行，在时间片用完后进行 processes 切换，实现多任务运行</p><p>在任何多道程序设计系统中，CPU 由一个进程快速切换至另一个进程，使每个进程各运行几十或几百个毫秒。严格地说，在某一个瞬间，CPU 只能运行一个进程。但在 1 秒钟期间，它可能运行多个进程，这样就产生并行的错觉，伪并行就是这样的情况，以此来区分多处理系统（有两个或多个 CPU 共享一个物理内存）的真正并行。这种切换行为叫做上下文切换</p><p>当一个时间片被消耗完后，不管进程正在执行什么代码，都一定会发生上下文切换，否则会产生误解：</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // bar() 不一定紧接着 foo() 后执行</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  bar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在现实的 Linux 中，并不能保证 bar() 紧接在 foo() 之后执行。如果 foo() 执行完后刚好消耗完时间片，则 bar() 的执行就会延后</p><h3 id="进程状态" tabindex="-1"><a class="header-anchor" href="#进程状态"><span>进程状态</span></a></h3><p>系统中究竟运行着多少个进程使用 ps ax 命令可以按照一行一个进程的格式列举出系统中当前正在运行的所有进程。然后，根据执行该命令而输出的行数，就能直接得知正在运行的进程总数</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">❯</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ps</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>进程存在几种状态，系统上的大部分进程处于睡眠态</p><table><thead><tr><th>状态名</th><th>含义</th></tr></thead><tbody><tr><td>运行态</td><td>正在逻辑 CPU 上运行</td></tr><tr><td>就绪态</td><td>进程具备运行条件，等待分配 CPU 时间</td></tr><tr><td>睡眠态</td><td>进程不准备运行，除非发生某事件。在此期间不消耗 CPU 时间</td></tr><tr><td>僵死状态</td><td>进程运行结束，正在等待父进程将其回收</td></tr></tbody></table><p>处于睡眠态的进程所等待的事件有以下几种</p><ul><li>等待指定的时间（比如等待 3 分钟）</li><li>等待用户通过键盘或鼠标等设备进行输入</li><li>等待 HDD 或 SDD 等外部存储器的读写结束</li><li>等待网络的数据收发结束</li></ul><p>通过查看 ps ax 的输出结果中的第 3 个字段 STAT 的首字母，就可以得知进程处于哪种状态</p><table><thead><tr><th>STAT 字段的首字母</th><th>状态</th></tr></thead><tbody><tr><td>R</td><td>运行态或者就绪态</td></tr><tr><td>S 或 D</td><td>睡眠态。S 指可通过接收信号回到运行态，D 指 S 以外的情况（D 主要出现于等待外部存储器的访问时）</td></tr><tr><td>Z</td><td>僵死状态</td></tr></tbody></table><p>需要注意的是，处于 D 状态的进程通常会在几毫秒之内迁移到别的状态。当出现长时间处于 D 状态的进程时，需要考虑是否发生了以下状况</p><ul><li>存储器的 I/O 处理尚未结束</li><li>内核中发生了某种问题</li></ul><p>进程在被创建后的整个生命周期中，会不断地在运行态、就绪态和睡眠态之间辗转，并非简单地使用完分配到的 CPU 时间后就立刻结束</p><p><img src="/assets/process_state_transition-DzgwMqNm.png" alt="进程状态转换"></p><p>如果没有任何需要运行的进程，在此期间，逻辑 CPU 会运行一个被称为空闲进程的不执行任何处理的特殊进程。空闲进程最简单的实现方式就是创建一个新进程，或者在唤醒处于睡眠态的进程之前执行无意义的循环。但因为这样会浪费电，所以通常并不会这样处理，而是使用特殊的 CPU 指令使逻辑 CPU 进入休眠状态，直到出现就绪态的进程。大家的计算机和智能手机之所以在不运行程序时能够待机更长时间，主要就得益于逻辑 CPU 能够进入空闲状态</p><p>在现实中的系统中，各个进程会根据不同的处理转换到各种不同的状态，在逻辑 CPU 上运行的进程也会随之发生变化，但重点只有两个</p><ul><li>在逻辑 CPU 上同一时间只能运行一个进程</li><li>睡眠态的进程不会占用 CPU 时间</li></ul><h3 id="吞吐量和延迟" tabindex="-1"><a class="header-anchor" href="#吞吐量和延迟"><span>吞吐量和延迟</span></a></h3><p>下面将介绍吞吐量和延迟这两个表示处理性能的指标的概念，它们的定义如下所示</p><ul><li>吞吐量：单位时间内的总工作量，越大越好</li><li>延迟：各种处理从开始到完成所耗费的时间，越短越好</li></ul><p>这两个指标不仅适用于逻辑 CPU，对于评价其他硬件（例如外部存储器等）的性能来说也非常重要。但是，为了便于理解，这里将集中讲解逻辑 CPU 的处理性能。下面是这两个指标的计算公式</p><ul><li>吞吐量 = 处理完成的进程数量 / 耗费的时间</li><li>延迟 = 结束处理的时间 – 开始处理的时间</li></ul><p>可以有以下结论：</p><ul><li>在耗尽逻辑 CPU 的计算能力后，也就是说，当所有逻辑 CPU 都不处于空闲状态后，不管继续增加多少个进程，吞吐量都不会再发生变化</li><li>随着进程数量的增加，延迟会越来越长</li><li>每个进程的平均延迟是相等的</li></ul><p>在允许运行多个进程时，假如调度器并没有通过轮询调度的方式进行调度，会非常的不公平，虽然吞吐量不变，但是进程的延迟变了，正是为了避免这样的情况出现，调度器才把逻辑 CPU 的 CPU 时间划分为时长很短的时间片来分配给各个进程</p><p>当逻辑 CPU 始终处于工作状态（即没有空闲状态）并且没有程序处于就绪态时，吞吐量与延迟就是最优值。但是，现实中并没有这么多恰好的事情。在现实中的系统中，逻辑 CPU 会在下列状态之间不断转换</p><ul><li>空闲状态。由于逻辑 CPU 处于空闲状态，所以吞吐量会降低</li><li>进程正在运行，且没有处于就绪态的进程，这是一种理想的状态。如果在这样的状态下加入一个处于就绪态的进程，则两个进程的延迟都会变长</li><li>进程正在运行，且存在就绪态的进程。这时吞吐量很大，但是延迟会变长</li></ul><p>查看<code>sar -q 1 1</code>的 runq-sz 字段查看处于运行态和就绪态的进程总数</p><h3 id="多个逻辑-cpu-时的调度" tabindex="-1"><a class="header-anchor" href="#多个逻辑-cpu-时的调度"><span>多个逻辑 CPU 时的调度</span></a></h3><p>当存在多个逻辑 CPU 时，如何进行调度呢？为了能够利用各个逻辑 CPU，调度器会运行一个被称为负载均衡或全局调度的功能。简单来说，负载均衡负责公平地把进程分配给多个逻辑 CPU。与只有单个逻辑 CPU 时的情况相同，在各个逻辑 CPU 内，调度器为在逻辑 CPU 上运行的各个进程分配均等的 CPU 时间</p><ul><li>对于多核 CPU 的计算机来说，只有同时运行多个进程才能提高吞吐量。另外，“有 n 个核心就有 n 倍性能”这种说法，说到底也只存在于理想状态中</li><li>与只有单个逻辑 CPU 时一样，当进程数量多于逻辑 CPU 数量时，吞吐量就不会再提高</li></ul><h3 id="运行时间和执行时间" tabindex="-1"><a class="header-anchor" href="#运行时间和执行时间"><span>运行时间和执行时间</span></a></h3><p>通过 time 命令运行进程，就能得到进程从开始到结束所经过的时 间，以及实际执行处理所消耗的时间</p><ul><li>运行时间：进程从开始运行到运行结束为止所经过的时间。类似于利用秒表从开始运行的时间点开始计时，一直测量到运行结束</li><li>执行时间：进程实际占用逻辑 CPU 的时长</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>❯ time ./c.out </span></span>
<span class="line"><span>Hello World</span></span>
<span class="line"><span></span></span>
<span class="line"><span>________________________________________________________</span></span>
<span class="line"><span>Executed in    2.59 millis    fish           external</span></span>
<span class="line"><span>   usr time    2.48 millis  590.00 micros    1.89 millis</span></span>
<span class="line"><span>   sys time    0.24 millis  244.00 micros    0.00 millis</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>real 的值为运行时间，user 与 sys 的和为执行时间</p><p>user 表示进程在用户模式下耗费的 CPU 时间。与此对应的 sys 则表示内核为了响应用户模式发出的请求而执行系统调用所耗费的时间</p><p>可以通过<code>ps -eo pid,comm,etime,time</code> 的 etime 和 time 字段输出当前系统各个进程的运行时间和执行时间</p><h3 id="优先级调度" tabindex="-1"><a class="header-anchor" href="#优先级调度"><span>优先级调度</span></a></h3><p>系统会均等地分配 CPU 时间给所有可以运行的进程，但是，为特定的进程指定优先级也是可以的，在 Linux 中通过<code>nice</code>来指定程序的运行优先级，nice 能通过 -19 和 20 之间的数来设定进程的运行优先级（默认值为 0），其中，-19 的优先级最高，20 的优先级最低。优先级高的进程可以比普通进程获得更多的 CPU 时间。与此相反，优先级低的进程会获得更少的 CPU 时间</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nice</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nice</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nice</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -20</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ps</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">F</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> S</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   UID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     PID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    PPID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PRI</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  NI</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ADDR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SZ</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> WCHAN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  TTY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          TIME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> CMD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> S</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   18906</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   18891</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 59236</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> futex_</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pts/0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fish</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> T</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   19763</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   18906</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  3719</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> do_sig</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pts/0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> T</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   19828</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   18906</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  90</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  3719</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> do_sig</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pts/0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> T</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   19988</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   18906</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  99</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  3719</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> do_sig</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pts/0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> T</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   20062</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   18906</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  60</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -20</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  3719</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> do_sig</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pts/0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> R</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   20121</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   18906</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  2760</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      pts/0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ps</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 sar 命令的输出中，%nice 字段的值表示在从默认值0 更改为其他优先级后，进程运行时间所占的比例。在不使用 nice 命令时，%user 的值为 100；与此相对，在使用 nice 命令后，%nice 的值变成了 100</p><h3 id="多线程" tabindex="-1"><a class="header-anchor" href="#多线程"><span>多线程</span></a></h3><p>一个进程可以有多个线程的执行单元组成，每个线程运行在进程的上下文中，共享同样的数据，多线程相比多进程要更加的高效</p><h3 id="硬件中断" tabindex="-1"><a class="header-anchor" href="#硬件中断"><span>硬件中断</span></a></h3><p>硬件中断是 CPU 接收到外部事件如 I/O 设备请求的信号，发生在 CPU 执行指令的时间里。比如鼠标点击、网卡包到来等都可能产生中断。CPU 会暂停当前工作，转而服务中断请求的程序，即中断处理程序</p><p>中断避免设备等待 CPU，实现快速响应</p><h2 id="虚拟内存" tabindex="-1"><a class="header-anchor" href="#虚拟内存"><span>虚拟内存</span></a></h2><p>虚拟内存是一个抽象的概念，它为每个进程提供了一个假象，也就是每个进程在独占的使用主存。每个进程看到的内存都是一致的，称之为虚拟地址空间</p><h2 id="文件" tabindex="-1"><a class="header-anchor" href="#文件"><span>文件</span></a></h2><p>文件这个简单而精致的概念是非常强大的，因为它向应用程序提供了一个统一的视图，来看待系统中可能含有的所有的各式各样的 I/O 设备</p><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h2><ul><li>现代操作系统（第3版）</li><li><a href="https://www.myfreax.com/linux-tutorial/" target="_blank" rel="noopener noreferrer">https://www.myfreax.com/linux-tutorial/</a></li><li><a href="https://github.com/jlevy/the-art-of-command-line" target="_blank" rel="noopener noreferrer">命令行的艺术</a></li></ul></div><!----><!----><!--[--><h2 id="doc-contributors" tabindex="-1"><a href="#doc-contributors" class="header-anchor"><span>贡献者</span></a></h2><div class="vp-contributors"><a href="https://github.com/JQiue" target="_blank" rel="noreferrer" class="vp-contributor"><!----><span class="vp-contributor-name">JQiue</span></a></div><!--]--></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/JQiue/jqiue-notes/edit/master/docs/operating-system/README.md" aria-label="在 GitHub 上编辑此页" rel="noopener noreferrer" target="_blank" iconsizing="both"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">最近更新：</span><time class="vp-meta-info" datetime="2025-06-19T06:51:15.000Z" data-allow-mismatch>2025/6/19 06:51</time></div></div></footer><nav class="vp-page-nav"><!----><a class="route-link auto-link next" href="/operating-system/windows.html" aria-label="Windows" iconsizing="both"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">Windows<!----></div></a></nav><div id="comment" class="waline-wrapper vp-comment" vp-comment darkmode="false" style="display:block;"><!----></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer"><a href="https://beian.miit.gov.cn/" target="_blank">备案号：鄂ICP备2021016538号</a></div><div class="vp-copyright">Copyright © 2019-present JQiue | Latest push: 6/19/2025, 6:51:39 AM</div></footer></div><!--]--><!--[--><!----><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BvEWR9Cw.js" defer></script>
  </body>
</html>
