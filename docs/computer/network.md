---
title: 跨越空间 - 计算机网络
category: 计算机原理
article: false
---

如何让计算机之间进行通信、资源共享等这就是计算机网络需要解决的事情

网络是由若干个节点和连接这些节点的链路组成、笔记本、台式电脑、打印机都是网络中的一个节点，它们通过链路互相连接，链路可以是有线或无线，这是最简单的网络

多个网络可以通过路由器互连，形成范围更大的网络，即互联网，互联网也称为网络的网络

每天使用的网络叫因特网，是世界上最大的网络，用户以亿计之，互连的网络以百万计之，连接因特网上的计算机称为主机

因特网的推进：

1. 从单个网络向互联网发展：第一个分组交换网诞生、开始研究网络之间的互连、TCP/IP协议成为标准
2. 逐步构建出三级结构的因特网：NSF 围绕六个大型计算机中心建设 NSFNET，即主干网、地区网和校园网
3. 形成多层次的 ISP 结构的因特网：NSFNET 逐渐被商用的因特网主干网替代、让各种因特网服务提供者 ISP 来运营

普通用户实际上是通过 ISP 接入因特网的，ISP 可以从因特网管理机构申请到成块的 IP 地址、同时拥有通信线路以及路由器等联网设备，任何机构和个人只要向 ISP 交纳费用，就可以从 ISP 得到所需要的 IP 地址。IP 地址很重要，因为因特网上的设备必须有 IP 地址才能通信。我国主要的 ISP 服务商主要有中国电信、中国联通、中国移动三大运行商组成

根据提供服务的覆盖面积大小及拥有的 IP 地址数量不同，ISP 也分为不同的层次：

+ 第一层：通常被称为因特网主干网，能覆盖国际性区域范围，拥有高速链路和交换设备
+ 第二层：是第一层 ISP 的用户，具有区域性或国家性覆盖规模，与第一层相连接
+ 第三次：是第二层 ISP 的用户，只拥有本地范围的网络、比如校园网、企业网、以及住宅用户或无线移动用户

相隔较远的主机通信可能需要经过多个 ISP，一个用户一旦接入因特网，本身也可以成为 ISP，只需要购买调制解调器或路由器等设备，让其他用户和它相连

从工作方式来看，计算机网络可分为边缘部分和核心部分。边缘部分由所有连接到因特网上供用户使用的主机，比如手机、电脑等；核心部分由大量的网络和连接网络的路由器组成

从组成部分来看，一个完整的计算机网络由硬件、软件、协议三大部分组成。硬件主要指：主机、通信链路、交换设备和通信设备等；软件主要指：用户使用的各种软件；协议指：网络传输数据时需要遵循的规范

从功能组成来看，计算机网络由通信子网和资源子网组成。通信子网由各种传输介质、通信设备和响应的网络协议组成；资源子网是实现资源共享的设备及其软件的集合，向网络用户提供服务

计算机网络的功能：

+ 数据通信 - 最基本最重要的功能，实现信息的传输
+ 资源共享 - 分工协作，互通有无
+ 分布式处理 - 将一个复杂的任务分配给网络中的其他计算机处理
+ 提高可靠性 - 在网络中的每个计算机都可以通过网络称为替代机
+ 负载均衡 - 将工作均衡的分配给网络中的各台计算机

## 交换方式

+ 电路交换 - 发送和接收方建立一条专用的通路、数据交换效率低
+ 报文交换 - 将数据加上地址等信息，进行转发，每个报文自行选择路线
+ 分组交换 - 将数据分成小的数据块，通过报文的方式传输、

电路交换优点有通信时延小、有序传输、没有冲突、适用范围广、实时传播，缺点是建立连接时间长、线路独占，通信效率低、灵活性差、难以规模化

报文交换优点有无需建立连接、动态分配线路、提高线路可靠性，提高线路利用率、提供多目标服务、缺点是时延高、需要较大的存储空间，需要传输额外的信息量

分组交换优点有无需建立连接、线路利用率高、简化存储管理、加速传输、减少出错概率和重发数据量，缺点是时延高、需要传输额外的信息量、对于数据报服务、存在失序、丢失或重复分组的问题；对于虚电路服务存在呼叫建立、数据传输和虚电路释放三个过程

## 分类

按照分布范围，计算机网络可分为：

+ 广域网 - 几千米到几十千米
+ 城域网 - 几个街区或整个城市
+ 局域网 - 一个房子，一个教室
+ 个人区域网 - 几十米

按传输技术分类：

+ 广播式网络 - 共享一个公共通信信道
+ 点对点网络 - 每条物理线路连接一对计算机

按拓扑分类：

+ 总线型
+ 星形
+ 环形
+ 网状形

按传输介质分类：有线网络和无线网络

## 性能

时延：

+ 发送时延 - 从发送分组的第一个比特算起，到该分组的最后一个比特发送完毕所需要的时间
+ 传播时延 - 一个比特从链路一端到另一端所需要的时间
+ 处理时延 - 分析地址部分、进行差错校验等花费的时间
+ 排队时延 - 在进入路由器后等待处理的时间

往返时延：从发送端发送数据开始，到发送端收到来自接收端的确认所花费的总共时间

吞吐量：时间单位内通过某个网络的数据量
速率：连接到网络上的主机在数字信道上传输数据的速率，也叫数据率或比特率。通常将最高数据率称之为带宽

时延带宽积：发送端第一个比特到达终点，发送端已经发送了多少个比特。时延带宽积 = 传播时延 * 信道带宽

## 协议、接口与服务

协议及规则的集合，由语法、语义和同步三部分组成。语法规定了传输数据的格式；语义规定了所要完成的功能；同步规定了执行各种操作的时序关系等

接口是相邻两层交换信息的连接点

服务是指下层为紧邻的上层提供的功能调用

::: tip
协议和服务在概念上是不一样的，只有在本层协议的实现才能保证向上层提供服务
:::

计算机网络的服务可分为：

+ 面向连接服务 - 通信双方必须先建立连接，分配资源，再进行数据传输，结束后释放连接
+ 无连接服务 - 通信双方不需要建立连接，需要发送数据时可直接发送，通常被称为“最大努力交付”
+ 可靠服务 - 网络具有纠错、检查的机制，保证数据传输的正确性和可靠性
+ 不可靠服务 - 网络不具备纠错、检查的机制，正确性和可靠性由应用或用户来保障
+ 有应答服务 - 接收方在收到数据后向发送方给出相应的应答
+ 无应答服务 - 接收方在收到数据后不向发送方给出相应的应答

## 分层结构

每层都实现一种相对独立的功能，降低大系统的复杂度，各层之间界面清晰，易于理解，相互交流尽可能少。各层功能的精确定义独立于具体的实现方法，可以采用最合适的技术实现。保持下层对上层的独立性、上层单向使用下层提供的服务，整个分层结构应该能够促进标准化工作

A 公司的老板想要和 B 公司的老板商量一些事情，A 公司的老板先把事情整理好交给秘书，秘书再往下传递，最后交给一个具体的人去 B 公司地址，然后找到 B 公司的相关人员，该人员向 B 公司秘书报告，最后再由 B 公司的秘书告诉老板

ISO/OSI 模型：

+ 应用层 - 是用户与网络的层面
+ 表示层 - 处理两个通信系统中交换信息的表示方式、数据压缩。加密和解密也是表示出提供的数据表示变换功能
+ 会话层 - 允许不同主机上的各个进程之间进行会话，利用传输层提供端对端的服务，为表示层或用户进程建立连接并在连接上有序的传输数据，也称建立同步
+ 传输层 - 传输单位是报文段（TCP）或用户数据报（UDP），负责主机中两个进程之间的通信
+ 网络层 - 传输单位是数据报，任务是把网络层的分组从源端传到目的端，为分组交换网上的不同主机提供通信服务
+ 数据链路层 - 传输单位是帧，任务是将网络层传来的 IP 数据报组装成帧，功能是成帧、差错控制、流量控制和传输管理等
+ 物理层 - 传输单位是比特，任务是透明的传输比特流，功能是在物理媒介上为数据端传输透明的传输原始比特流

TCP/IP 模型：

+ 应用层 - ISO/OSI 中的“应用层、表示层、会话层”
+ 传输层 - ISO/OSI 中的“传输层”
+ 网际层 - ISO/OSI 中的“网络层”
+ 网络接口层 - ISO/OSI 中的“数据链路层，物理层”

ISO/OSI 和 TCP/IP 的不同：

+ OSI 模型定义了三个主要的概念：服务、协议和接口。TCP/IP 在这三个概念上没有区分
+ OSI 模型在网络层支持无连接和面向连接的通信，但在传输层仅有面向连接的通信。TCP/IP 在网际层仅有一种无连接的通信模式，但在传输层支持无连接和面向连接两种模式

## 蜂窝网络

在全球，有很多手机用户，以及很多互联网用户，几乎人人都在接触网络，今天的时代是“云”的时代

对于公司来说，它的内部网络可能由下面几个部分组成：

+ 通信链路
+ 无线路由器
+ 交换机
+ 路由器
+ 边缘路由器
+ 本地 ISP

通信链路是一个抽象的概念，同轴线缆、无线信号、蓝牙信道都是具体的实现

通信需要发生数据交换，交换的本质就是让数据切换路径，因为网络中的数据是以分组或封包的形式进行发送的，路由器和交换机都是用来承载封包交换的设备，最外部的路由器被称为边缘路由器，可以将公司内部的网络发送到外部的网络。公司内部的交换机或路由器组成了一定程度上的局域网，设备之间可以互相通信

在移动网络中，无线信号构成了通信链路，通信的核心被称为蜂窝塔，也叫基站，如果要覆盖很大的区域就需要很多的蜂窝或基站，因此就构成了蜂窝网络

家用网络、公司网络、移动网络、区域性 ISP、国家性或全球性 ISP 构成了整个互联网

传递数据时，发送和接收设备被称之为终端、端系统、主机，端到端之间的能力由 TCP/IP 协议群提供，同时还有一些一对多、多对多是对端到端的能力延伸

一条数据在发送到指定设备时，可能经过路由器、交换机、基站，甚至不同的通信链路

网路设施通常不能一次性传输太大的数据量，会采用分段传输，这样重新传输的代价不会很高，并且每段数据有可能走不同的路线最终到达另一端

从整体上来看互联网是立体的、庞大的网络结构，从微观上来看就是一个个设备

## TCP

在 TCP 中设备是平等的，不区分客户端、服务端，它们都被称为主机

TCP 是一个传输层的协议，提供了端到端数据的可靠传输，支持全双工，是一个以链接为导向的协议，一个设备通过 TCP 协议发送数据到另一个设备

TCP 协议往上是应用到应用的协议，也叫应用层，需要告知 TCP 是哪一个应用，通过端口号进行区分

TCP 在传输时必须要知道网络地址，但是 TCP 不会处理网络地址上的东西，而是会交给下一层的网络层，用来确定地址到地址的通信

网络层不会负责信号在两个设备之间的具体传递，而是交给下一层的数据链路层

因此主机到主机之间的传输具有五层：

+ 应用层
+ 传输层
+ 网络层
+ 数据链路层
+ 物理层

TCP 具有以下特性：

+ 可靠性 - 数据传输时是无损的
+ 多播 - 可以发送给多个接收方，由于可靠性，如果一个接收方收到了数据，那么所有的接收方都必须接收到该消息

## 连接和会话

连接是通信双方之间的约定，在传输数据之前，双方都会在内存中建立一个用于维护数据传输状态的对象，比如 IP 和端口是多少、发送了多少数据、传输速度如何，因此连接是网络行为状态的记录

会话是应用的行为，会话会维护连接的状态，因为连接是可以随时断开的

## 单工/双工

在任何一个时刻，数据只能单向发送，这就是单工，因此只需要一条线路即可满足

如果在某个时刻数据可以向一个方向传输，也可以在另一个方向传输回来，但是只能允许一个方向的传输，就是半双工，至少需要一条线路满足

在任何时刻都可以双向传输，就是全双工，必须大于一条线路才能满足

TCP 就是一个双工协议

## TCP 的握手和挥手

TCP 是一个以连接为导向的协议，设计有连接和断开连接的情况，分别被称为握手和挥手

<!-- more -->
